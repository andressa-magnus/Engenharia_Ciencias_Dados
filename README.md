A motivação para este estudo surge de um problema real: o diagnóstico por radiografia depende muito da experiência do radiologista, o que pode gerar variações na interpretação. Além disso, em momentos de alta demanda, como ocorreu na pandemia, a análise manual se torna ainda mais desafiadora. Portanto, o objetivo deste trabalho é desenvolver um sistema de apoio ao diagnóstico que possa auxiliar profissionais de saúde, oferecendo uma segunda opinião rápida, consistente e interpretável.

Para isso, eu construí dois modelos de classificação de imagens: uma CNN desenvolvida completamente do zero, e uma ResNet50 utilizando Transfer Learning com Fine-Tuning. A ideia foi comparar uma solução mais simples, criada do zero, com um modelo mais robusto, pré-treinado em um grande dataset, e entender como cada abordagem se comporta no problema.

Primeiro, eu reuni diferentes datasets públicos do Kaggle e realizei um processo de unificação e padronização das imagens, formando três classes: COVID-19, Normal e Pneumonia. Todas as classes foram balanceadas de forma uniforme, totalizando cerca de 16 mil imagens divididas em treino, validação e teste.

A análise exploratória do dataset mostrou que as imagens tinham boa variabilidade visual, resolução consistente e intensidade equilibrada. Isso foi importante para confirmar que a base de dados tinha qualidade suficiente para treinar modelos profundos. Também analisamos padrões de textura, distribuições de brilho e a presença de possíveis ruídos.

Após isso, foi realizado o pré-processamento das imagens, incluindo redimensionamento para 224 por 224 pixels, normalização, e data augmentation, como rotações, zoom e flips horizontais. Além disso, calculamos pesos de classe para lidar com qualquer pequeno desbalanceamento residual.

O primeiro modelo construído foi uma CNN do zero, composta por três blocos convolucionais, seguidos de camadas densas e dropout. Treinei esse modelo por 20 épocas, com callbacks como Early Stopping, redução de Learning Rate e salvamento do melhor modelo. O desempenho final atingiu 87% de acurácia e um F1-Macro também de 87%. É um resultado sólido para um modelo treinado completamente do zero. Porém, ao analisar os mapas Grad-CAM, percebemos que as ativações nem sempre estavam bem localizadas nas regiões pulmonares, o que indicava limitação na capacidade de generalização.

Em seguida, foi treinada a ResNet50 com Transfer Learning. Inicialmente, as camadas convolucionais foram congeladas e apenas o classificador final foi treinado. Depois, realizamos o Fine-Tuning, descongelando as últimas 30 camadas do backbone. O modelo convergiu rapidamente e apresentou métricas significativamente superiores: 94% de acurácia e um F1-Macro de aproximadamente 93,5%. Os mapas de Grad-CAM translúcido mostraram que esse modelo conseguia focar de forma mais precisa nas regiões relevantes dos pulmões, reforçando sua interpretabilidade.

Quando comparamos os dois modelos diretamente, a ResNet50 supera a CNN do zero em todos os aspectos: acurácia, estabilidade, tempo de convergência e coerência visual dos mapas de ativação. Isso reforça a importância de arquiteturas pré-treinadas, especialmente em contextos médicos onde os padrões são complexos.

Apesar dos bons resultados, discutimos também limitações e possíveis vieses. Os principais riscos incluem diferenças entre equipamentos de raio-X, variações de qualidade entre hospitais, erros de rotulagem e o fato de que Grad-CAM fornece apenas explicações aproximadas. Além disso, modelos treinados com dados de um único domínio podem apresentar queda de performance quando aplicados em novos cenários.

Para concluir, este trabalho demonstrou que modelos de Deep Learning conseguem auxiliar na detecção de COVID-19 e pneumonia, oferecendo análises rápidas e interpretáveis. A CNN do zero mostrou-se uma boa linha de base, mas a ResNet50, com transferência de aprendizado e fine-tuning, apresentou desempenho claramente superior. Mesmo assim, reforço que o uso clínico de modelos como esses exige validação externa, auditoria de vieses e supervisão contínua por especialistas.
